The project is about predicting volatility of company stocks using regression. 

It uses the following dataset for training and testing: http://www.csie.ntu.edu.tw/~cjlin/libsvmtools/datasets/regression/E2006.train.bz2<br/>
The dataset has been generated by mining the reports on Form 10-k that companies filed with SEC(Securities and Exchange Commission).<br/>
There are 16,087 examples available. There are 150,360 features, corresponding to different words in the reports.<br/>

The dataset is different in the sense that it contains more features than samples.<br/>
Mathematically speaking this system has more variables than equations (Underdetermined system). Such a system can have infinitely many solutions.<br/>
If regularization is not used, then we may find models with 100% training accuracy but they will generalize rather poorly (overfitting). So it is necessary to use regularization in this case.<br/>

Main.py loads the data and uses it to train Linear Regression Model(available in sklearn.linear_model).<br/>
The model is trained using KFold cross-validation.<br/>
The results are following(without regularization):<br/>

* Train R2 score = 0.99999261654 (overfitting - will not generalize well)
* Test R2 score = -0.129615667613

For regularization ElasitcNet has been used (available from sklearn.linear_model).<br/>
ElasticNet is a Linear regression model with combined L1 and L2 priors as regularizer.<br/>
The penalty term is: a * L1 + b * L2 where: alpha = a + b and l1_ratio = a / (a + b).<br/>
There is significant improvement in R2 scores (using alpha = 0.1, l1_ratio = 0.5): <br/>

* Train R2 score = 0.606471796547
* Test R2 score = 0.606507736107

Tuning the hyperparameters:<br/>
For finding the optimum alpha and l1_ratio ElasitcNetCV has been used.<br/>
It takes a list of l1_ratios as parameter and calculates a list of alphas for each l1_ratio. And for each (alpha, l1_ratio) value it trains and tests the model storing the pair that give optimum R2 score.<br/>
<p>l1_ratio = `[.5, .9, .95, 1.0`] (Since the input is very sparse, L1 penalty is preferred)<p>
Results:

* Train R2 score = 0.653843711527
* Test R2 score = 0.653738364217
* clf.alpha_ = 0.000303368283226
* clf.l1_ratio_ = 1.0

Finally, actual values vs predicted values curves have been plotted.

Contents:

1. main.py - entry point, loads data, trains and tests model.
2. model.py - contains function for training and testing the model
3. plot.py - contains plotting functions
4. Regression over SEC data(Actual Values and Predicted Values for samples).png - visualization of actual vs predicted values
5. Regression over SEC data(Actual Values vs Predicted Values).png - visualization of actual vs predicted values



